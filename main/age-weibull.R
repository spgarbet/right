age_distribution <- data.frame(
  male_shape = c(
    6.617658441,
    7.621428853,
    7.485490431,
    7.308765069,
    7.453001382,
    7.384675248,
    7.20594779,
    7.081786737,
    7.104105565,
    6.907207044,
    6.615031062,
    6.775177985,
    6.596367641,
    6.58089463,
    6.382931959,
    6.28577674,
    6.198497572,
    6.01093085,
    6.053011085,
    5.91008722,
    5.828367421,
    5.78899062,
    5.617064484,
    5.632046963,
    5.413557499,
    5.357971041,
    5.343351034,
    5.267493648,
    5.134475217,
    5.075271313,
    5.003347466,
    4.875502651,
    4.871819802,
    4.840033969,
    4.637462606,
    4.521390477,
    4.438022145,
    4.404460451,
    4.233304296,
    4.208362462,
    4.130791031,
    4.119719076,
    3.914711536,
    3.904023873,
    3.827437097,
    3.712991633,
    3.762397762,
    3.605185415,
    3.555025794,
    3.545644373,
    3.330788579,
    3.379306209,
    3.277052885,
    3.171993919,
    3.200755145,
    2.995856571,
    3.021731344,
    3.001956778,
    2.951210095,
    2.81425167,
    2.820263439,
    2.716713363,
    2.661353987,
    2.604676204,
    2.618505435,
    2.520377799,
    2.476961287,
    2.43249785,
    2.340901459,
    2.34245019,
    2.211285625,
    2.237635581,
    2.172340774,
    2.099448843,
    2.073560778,
    2.027119772,
    1.991404614,
    1.951267082,
    1.897313987,
    1.861916058,
    1.822532183,
    1.771282378,
    1.749547836,
    1.709592197,
    1.689198103,
    1.659288451,
    1.648017932,
    1.606528536,
    1.608988959,
    1.58814846,
    1.564859104,
    1.540948972,
    1.538964351,
    1.517736309,
    1.534132237,
    1.528121177,
    1.516209223,
    1.524896475,
    1.544838848,
    1.540996593,
    1.592707182,
    1.601176275,
    1.638903046,
    1.712225278,
    1.767390675,
    1.872842052,
    2.060595467,
    2.375215787,
    3.068289064
  ),
  female_shape = c(
    5.490364706,
    6.222806513,
    6.204149245,
    6.17168388,
    5.993426388,
    5.959998047,
    5.838469553,
    5.69725421,
    5.743500245,
    5.611831972,
    5.529440659,
    5.410406599,
    5.355548297,
    5.252049781,
    5.188536058,
    5.032230424,
    4.940515026,
    4.915499763,
    4.925309043,
    4.765735624,
    4.63889999,
    4.5314193,
    4.569944006,
    4.560027389,
    4.487339018,
    4.269651892,
    4.378295709,
    4.254794802,
    4.261957769,
    4.248060904,
    4.10696328,
    3.950268168,
    4.053291277,
    3.922330764,
    3.860215102,
    3.830692718,
    3.660065474,
    3.66990227,
    3.565888819,
    3.540252859,
    3.46483804,
    3.369864935,
    3.367332921,
    3.1509021,
    3.240386529,
    3.144073007,
    3.081015963,
    3.022331943,
    2.919255166,
    2.859988258,
    2.837293452,
    2.739558961,
    2.715006833,
    2.654236526,
    2.611052487,
    2.570300419,
    2.541778417,
    2.439697689,
    2.428778285,
    2.415005846,
    2.38486419,
    2.331154058,
    2.339821322,
    2.288824685,
    2.23464874,
    2.173840944,
    2.191414971,
    2.109012971,
    2.069003134,
    2.034497387,
    1.993328998,
    1.930354062,
    1.944666743,
    1.89067093,
    1.867170891,
    1.84657541,
    1.808483767,
    1.768382932,
    1.732873775,
    1.714108832,
    1.693615231,
    1.668478421,
    1.625769827,
    1.609854986,
    1.620254687,
    1.591870794,
    1.556698579,
    1.569081615,
    1.529332771,
    1.512125913,
    1.514260398,
    1.521430471,
    1.488308729,
    1.484980286,
    1.487158594,
    1.520397659,
    1.505515758,
    1.524458657,
    1.54686648,
    1.546925094,
    1.564154244,
    1.607116655,
    1.628864236,
    1.703918263,
    1.758148688,
    1.878543564,
    2.045454461,
    2.333612885,
    3.07764399
  ),
  male_scale = c(
    86.94314993,
    86.7743903,
    85.47623146,
    84.66060361,
    83.71621223,
    82.73716571,
    81.72907386,
    80.55324169,
    79.71307515,
    78.54502686,
    77.46140796,
    76.76624218,
    75.63070095,
    74.74305719,
    73.56834219,
    72.59266551,
    71.55232228,
    70.36330506,
    69.62561495,
    68.48914629,
    67.41117693,
    66.36105361,
    65.46901529,
    64.48792566,
    63.42380478,
    62.47572087,
    61.47667442,
    60.42177495,
    59.28298664,
    58.43853784,
    57.61815796,
    56.54621822,
    55.59194615,
    54.82640523,
    53.38366302,
    52.41599093,
    51.41941009,
    50.34066546,
    49.44174601,
    48.58152913,
    47.48106626,
    46.62780179,
    45.40852718,
    44.41165907,
    43.48014158,
    42.5240276,
    41.76285259,
    40.61373511,
    39.65556229,
    38.69094099,
    37.55059851,
    36.78241356,
    35.76940729,
    34.66328938,
    33.96524665,
    32.86669398,
    32.01123266,
    31.11193699,
    30.22526933,
    29.04867402,
    28.22839045,
    27.27655857,
    26.36409892,
    25.51529364,
    24.74771418,
    23.89771425,
    22.93700784,
    22.1077021,
    21.03597419,
    20.34552538,
    19.26510793,
    18.82779606,
    17.81286177,
    16.99511518,
    16.11425148,
    15.39987419,
    14.6483299,
    13.77664484,
    13.10061412,
    12.44412282,
    11.75682915,
    11.11300854,
    10.37569407,
    9.745049623,
    9.255728843,
    8.595423643,
    8.178289029,
    7.502725144,
    7.008930024,
    6.661847207,
    6.145120776,
    5.723291496,
    5.385206767,
    5.034773964,
    4.689785718,
    4.404736976,
    4.116414745,
    3.917185082,
    3.654751688,
    3.412326298,
    3.24472547,
    3.102612432,
    2.877743473,
    2.711881341,
    2.543425433,
    2.356507878,
    2.138029587,
    1.87176453,
    1.511767641 
  ),
  female_scale = c(
    82.51205561,
    82.50123433,
    81.61755515,
    80.47858492,
    79.48678699,
    78.38362062,
    77.36761604,
    76.12889999,
    75.54060473,
    74.18789493,
    73.35511074,
    72.24711209,
    71.20794575,
    70.1158675,
    69.27011622,
    68.22804729,
    67.25763257,
    66.18190803,
    65.38433151,
    64.17866788,
    63.30411098,
    62.06255216,
    61.15163502,
    60.31497408,
    59.4515274,
    58.0820014,
    57.38338332,
    56.43197531,
    55.52128499,
    54.57899481,
    53.36958882,
    52.22163887,
    51.47696404,
    50.4880459,
    49.48126372,
    48.52732004,
    47.49505563,
    46.6475782,
    45.56706611,
    44.5778172,
    43.62824914,
    42.58246183,
    41.87810615,
    40.32627377,
    39.83740906,
    38.54468155,
    37.60485769,
    36.80472394,
    35.78599052,
    34.76018347,
    33.9847407,
    33.05302563,
    32.0332125,
    31.08317474,
    30.23968916,
    29.42920229,
    28.4678666,
    27.57178793,
    26.80742198,
    25.93088445,
    25.11343773,
    24.18135883,
    23.55310612,
    22.68645027,
    21.74024881,
    20.85593677,
    20.38339776,
    19.4318897,
    18.54882225,
    17.74142405,
    17.04031007,
    16.13819105,
    15.66983667,
    14.75559187,
    14.05096653,
    13.26525898,
    12.64457868,
    12.09288298,
    11.35956735,
    10.75756676,
    10.16764463,
    9.689705655,
    9.010659324,
    8.497981567,
    8.103139981,
    7.525592221,
    7.039096767,
    6.623634652,
    6.120277411,
    5.805688936,
    5.430487546,
    5.114084742,
    4.686236933,
    4.467877273,
    4.202301928,
    4.03833464,
    3.784735604,
    3.564415899,
    3.361214792,
    3.183814066,
    3.057172809,
    2.893486575,
    2.771314486,
    2.609535274,
    2.472908437,
    2.273706326,
    2.084569374,
    1.827160977,
    1.519498445
  )
)
# Note that the gender values flipped here (1 is now female)
ageAtDeath <- function(currentAge, gender)
{
  currentAge <- floor(currentAge)
  
  if(gender == 1 || gender == 'F' || gender == 'Female' || gender == 'f' || gender == 'female')
  {
    shape <- age_distribution$female_shape[currentAge]
    scale <- age_distribution$female_scale[currentAge]
  }
  else
  {
    shape <- age_distribution$male_shape[currentAge]
    scale <- age_distribution$male_scale[currentAge]
  }
  
  min(currentAge + rweibull(1, shape, scale), 110)
}